<?php
require_once 'includes/db.php';
require_once 'includes/auth.php';
require_once 'includes/functions.php';

if (!isAuthenticated()) {
    header('Location: login.php');
    exit();
}

$host_id = isset($_GET['host_id']) ? (int)$_GET['host_id'] : 0;
$vulnerabilities = getAllVulnerabilities($conn);
$error = '';
$success = '';

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $vulnerability_id = (int)$_POST['vulnerability_id'];
    $details = sanitizeInput($_POST['details']);

    if (addHostVulnerability($conn, $host_id, $vulnerability_id, $details)) {
        $success = 'Вразливість успішно додано';
    } else {
        $error = 'Помилка при додаванні вразливості';
    }
}

include 'add_vulnerability.html';

?>